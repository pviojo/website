
<% include ./partials/header  {header: header, pageData: req.pageData} %>
<div class="container secondary kiosk">
          <div class="row">
              <div class="col-lg-6 col-sm-12">
                <h2><%= pageData[0].fields.name %></h2>
                <h3><%= pageData[0].fields.subhead %></h3>
                <div class="kioskContent"><%= pageData[0].fields.content %></div>
                <div class="kiosk-list">
                <% var value = 0; %>
                <% kiosksData.forEach((kiosk) => { %>
                  <%value = value + 1%>
                   
                  <div class="kiosk-item">
                    <div class="kioskNumber"><%= value %></div>
                    <img src="/images/map_icon.svg">
                    <div class="kioskNumber"><%= value %></div>
                    <div class="wrapper">
                      <h5><%= kiosk.fields.locationName %></h5>
                      <p><%= kiosk.fields.details %></p>
                    </div>
                  </div>
                <% }) %>              
                </div>
                <div class="kiosk-text">
                  <%= pageData[0].fields.content2 %>
                </div>
              </div>
              <div class="col-lg-6 col-sm-12 kiosk-map">
                <div id="map"></div>
                <script>
                
                    function initMap() {
                    var kiosksLocations = <%- JSON.stringify(kiosksData) %>;
                    var locations = [];
                    var locationId = 0;
                    kiosksLocations.forEach((kiosks) => {
                      locationId = locationId + 1;
                      var kioskData = [kiosks.fields.locationName, kiosks.fields.location.lat, kiosks.fields.location.lon, kiosks.fields.details, locationId];
                      locations.push(kioskData);
                    })
                      
                      var uluru = {lat: 47.603845, lng: -122.334532};
                      var map = new google.maps.Map(
                          document.getElementById('map'), {
                            zoom: 12,
                           center: uluru,
                           styles: [
                                    {
                                      "elementType": "geometry",
                                      "stylers": [
                                        {
                                          "color": "#f5f5f5"
                                        }
                                      ]
                                    },
                                    {
                                      "elementType": "labels.icon",
                                      "stylers": [
                                        {
                                          "visibility": "off"
                                        }
                                      ]
                                    },
                                    {
                                      "elementType": "labels.text.fill",
                                      "stylers": [
                                        {
                                          "color": "#616161"
                                        }
                                      ]
                                    },
                                    {
                                      "elementType": "labels.text.stroke",
                                      "stylers": [
                                        {
                                          "color": "#f5f5f5"
                                        }
                                      ]
                                    },
                                    {
                                      "featureType": "administrative",
                                      "elementType": "geometry.fill",
                                      "stylers": [
                                        {
                                          "color": "#f2f4f6"
                                        }
                                      ]
                                    },
                                    {
                                      "featureType": "administrative.land_parcel",
                                      "elementType": "labels.text.fill",
                                      "stylers": [
                                        {
                                          "color": "#bdbdbd"
                                        }
                                      ]
                                    },
                                    {
                                      "featureType": "landscape",
                                      "elementType": "geometry.fill",
                                      "stylers": [
                                        {
                                          "color": "#eaecf0"
                                        }
                                      ]
                                    },
                                    {
                                      "featureType": "poi",
                                      "elementType": "geometry",
                                      "stylers": [
                                        {
                                          "color": "#eeeeee"
                                        }
                                      ]
                                    },
                                    {
                                      "featureType": "poi",
                                      "elementType": "geometry.fill",
                                      "stylers": [
                                        {
                                          "color": "#dddfe1"
                                        }
                                      ]
                                    },
                                    {
                                      "featureType": "poi",
                                      "elementType": "labels.text.fill",
                                      "stylers": [
                                        {
                                          "color": "#757575"
                                        }
                                      ]
                                    },
                                    {
                                      "featureType": "poi.park",
                                      "elementType": "labels.text.fill",
                                      "stylers": [
                                        {
                                          "color": "#9e9e9e"
                                        }
                                      ]
                                    },
                                    {
                                      "featureType": "road",
                                      "elementType": "geometry",
                                      "stylers": [
                                        {
                                          "color": "#ffffff"
                                        }
                                      ]
                                    },
                                    {
                                      "featureType": "road.arterial",
                                      "elementType": "labels.text.fill",
                                      "stylers": [
                                        {
                                          "color": "#757575"
                                        }
                                      ]
                                    },
                                    {
                                      "featureType": "road.highway",
                                      "elementType": "geometry",
                                      "stylers": [
                                        {
                                          "color": "#dadada"
                                        }
                                      ]
                                    },
                                    {
                                      "featureType": "road.highway",
                                      "elementType": "geometry.fill",
                                      "stylers": [
                                        {
                                          "color": "#ffffff"
                                        }
                                      ]
                                    },
                                    {
                                      "featureType": "road.highway",
                                      "elementType": "labels.text.fill",
                                      "stylers": [
                                        {
                                          "color": "#616161"
                                        }
                                      ]
                                    },
                                    {
                                      "featureType": "road.local",
                                      "elementType": "labels.text.fill",
                                      "stylers": [
                                        {
                                          "color": "#9e9e9e"
                                        }
                                      ]
                                    },
                                    {
                                      "featureType": "transit.line",
                                      "elementType": "geometry",
                                      "stylers": [
                                        {
                                          "color": "#e5e5e5"
                                        }
                                      ]
                                    },
                                    {
                                      "featureType": "transit.station",
                                      "elementType": "geometry",
                                      "stylers": [
                                        {
                                          "color": "#eeeeee"
                                        }
                                      ]
                                    },
                                    {
                                      "featureType": "water",
                                      "elementType": "geometry",
                                      "stylers": [
                                        {
                                          "color": "#c9c9c9"
                                        }
                                      ]
                                    },
                                    {
                                      "featureType": "water",
                                      "elementType": "geometry.fill",
                                      "stylers": [
                                        {
                                          "color": "#cad2d3"
                                        }
                                      ]
                                    },
                                    {
                                      "featureType": "water",
                                      "elementType": "labels.text.fill",
                                      "stylers": [
                                        {
                                          "color": "#9e9e9e"
                                        }
                                      ]
                                    }
                                  ]
                                  });
                      
                      var infowindow = new google.maps.InfoWindow();

                      var marker, i;
                      var iconBase = 'http://sfs.formdev.io/images/map_icon.svg';
                      

                      for (i = 0; i < locations.length; i++) {  
                        var number = locations[i][4]
                        marker = new google.maps.Marker({
                          position: new google.maps.LatLng(locations[i][1], locations[i][2]),
                          map: map,
                          icon: iconBase,
                          title: 'test',
                          label: {color: '#fff', fontSize: '20px', fontWeight: '700', text: number.toString()}
                        });
                        google.maps.event.addListener(marker, 'click', (function(marker, i) {
                        return function() {
                          infowindow.setContent('<div id="content">'+
                                          '<h3>' + locations[i][0] + '</h3>'+
                                          '<p>' + locations[i][3] + '</p>' +
                                          '<a href="https://www.google.com/maps/dir/' + locations[i][1] + '+' + locations[i][2] + '/@' + locations[i][1] + ',' + locations[i][2] + ',15z" target="_blank">Click For Directions</a>'+
                                          '</div>');
                          infowindow.open(map, marker);
                        }
                      })(marker, i));
                      }

                      
                        
                    }
                </script>
                <div class="study-callout">
                  <h3>Help us track the flu in Seattle. We need you.</h3>
                  <a href="/enroll"><button>Join the Study</button></a>
                </div>
              </div>
            </div>
          </div>
          <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC0HleARzOftDM3ACdiEpo_KIbWabTLf-Q&callback=initMap">
    </script>
          

<% include ./partials/footer  %>
